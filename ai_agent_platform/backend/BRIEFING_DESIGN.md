# 简报样式设计文档

## 设计理念

**核心原则**：清晰、优雅、信息密度高，但不冗余

- **类似小红书/Instagram 风格**：大图封面 + 卡片布局
- **颜色分层**：优先级和类型通过颜色快速传达
- **渐进式信息展示**：列表卡片 → 详情页 → 完整报告

---

## 📱 信息流列表 - 简报卡片

### 视觉结构

```
┌─────────────────────────────────────────────────┐
│  ┌───────────────────────────────────────────┐  │
│  │ [P1]                              • 未读  │  │ ← 封面图（240px 高）
│  │                                           │  │   渐变背景 + 半透明图标
│  │              🔔 大图标                     │  │
│  │                                           │  │
│  └───────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────┐  │
│  │ [👤] 研发效能分析官 [警报] 2小时前         │  │ ← Header
│  │                                           │  │
│  │ 返工率达50%，框架层全部变更需返工          │  │ ← 标题（粗体）
│  │                                           │  │
│  │ 最近3天的12个代码变更中，返工率达到         │  │ ← 摘要（3行）
│  │ 50%（超标3.3倍）。platform/frameworks    │  │
│  │ 模块最严重，5个变更全部需要返工...        │  │
│  │                                           │  │
│  │ ┌─────────────────────────────────────┐   │  │
│  │ │ ℹ️ 交付周期延长，团队效率下降30%     │   │  │ ← 影响说明（彩色块）
│  │ └─────────────────────────────────────┘   │  │
│  └───────────────────────────────────────────┘  │
└─────────────────────────────────────────────────┘
```

### 尺寸规格

| 元素 | 尺寸/规格 |
|------|----------|
| 卡片间距 | 横向 16px，纵向 12px |
| 卡片圆角 | 12px |
| 卡片阴影 | 未读：elevation 2，已读：0 |
| 封面高度 | 240px（固定） |
| 内容边距 | 16px（四周） |
| 标题字号 | TitleLarge（约 22sp） |
| 摘要字号 | BodyMedium（约 14sp） |
| 标题最大行数 | 2 行 |
| 摘要最大行数 | 3 行 |

### 颜色方案

#### 1. 优先级颜色（Priority Color）

| 优先级 | 颜色 | Hex | 用途 |
|--------|------|-----|------|
| **P0** | 红色 | `#F44336` | 紧急/严重问题 |
| **P1** | 橙色 | `#FF9800` | 重要问题 |
| **P2** | 蓝色 | `#2196F3` | 一般信息 |

**显示位置**：
- 封面图左上角的标签背景色
- 卡片边框颜色（半透明 30%）
- 未读标记圆点
- 影响说明区域背景（10% 透明度）

#### 2. 类型颜色（Type Color）

| 类型 | 颜色 | Hex | 图标 | 封面渐变 |
|------|------|-----|------|---------|
| **Alert（警报）** | 红色 | `#EF4444` | `warning_rounded` | `#FEE2E2` → `#FECACA` |
| **Insight（洞察）** | 紫色 | `#9333EA` | `lightbulb_rounded` | `#EDE9FE` → `#DDD6FE` |
| **Summary（摘要）** | 蓝色 | `#3B82F6` | `summarize_rounded` | `#DBEAFE` → `#BFDBFE` |
| **Action（待办）** | 绿色 | `#10B981` | `task_alt_rounded` | `#D1FAE5` → `#A7F3D0` |

**显示位置**：
- Header 中的类型标签背景（10% 透明度）
- 封面图渐变背景
- 大图标颜色（白色 40% 透明度）

#### 3. 状态标识

| 状态 | 显示方式 |
|------|---------|
| **未读** | 右上角红点（12px）+ 边框加粗（2px） |
| **已读** | 标题和文字变灰 `Colors.grey[600]` |

---

## 📄 详情页（全屏）

### 视觉结构

```
┌─────────────────────────────────────────────────┐
│ ← 研发效能分析官                 [分享] [跟踪] ⋮ │ ← AppBar
├─────────────────────────────────────────────────┤
│                                                 │
│  ┌───────────────────────────────────────────┐  │
│  │ [P1]                                      │  │ ← Hero 大图（320px）
│  │                                           │  │
│  │              🔔 大图标                     │  │
│  │                                           │  │
│  └───────────────────────────────────────────┘  │
│                                                 │
│  返工率达50%，框架层全部变更需返工               │ ← 大标题
│                                                 │
│  [👤 研发效能分析官] [警报] [P1] 2小时前        │ ← 元数据
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                                 │
│  💥 影响                                        │
│  ┌─────────────────────────────────────────┐   │
│  │ 交付周期延长，团队效率下降30%            │   │ ← 影响卡片
│  └─────────────────────────────────────────┘   │
│                                                 │
│  ## 分析结果                                    │
│                                                 │
│  最近3天的12个代码变更中，返工率达到...         │ ← Markdown 内容
│                                                 │
│  ### 核心指标                                   │
│  - 总变更数：12个                               │
│  - Review中位耗时：15.0小时                     │
│  ...                                            │
│                                                 │
│  [查看完整报告 📄]                              │ ← 报告按钮（可选）
│                                                 │
│  （留白）                                       │
├─────────────────────────────────────────────────┤
│ [深入分析]  [查看报告]  [开始对话 💬]           │ ← 底部操作栏
└─────────────────────────────────────────────────┘
```

### 关键元素

#### 1. Hero 大图（封面）
- **高度**：320px（比卡片更大）
- **动画**：从卡片点击时，图片会平滑放大到详情页
- **内容**：与卡片相同的渐变背景 + 图标

#### 2. 标题
- **字号**：HeadlineMedium（约 28sp）
- **粗体**：FontWeight.bold
- **颜色**：黑色（默认）

#### 3. 元数据行
```
[👤 Agent头像] Agent名称  [类型标签]  [优先级标签]  时间
```

#### 4. 影响说明卡片
```
┌────────────────────────────────────┐
│ 💥 影响                             │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│ 交付周期延长，团队效率下降30%       │
└────────────────────────────────────┘
```
- 背景色：优先级颜色 10% 透明度
- 边框：优先级颜色 20% 透明度
- 图标：`Icons.error_outline` 或 `Icons.info_outline`

#### 5. 内容区（Markdown）
- **可选中文本**：`selectable: true`
- **字号**：BodyLarge（16sp）
- **行高**：1.6（阅读友好）
- **代码块**：灰色背景 + 圆角
- **支持**：标题、列表、粗体、代码等

#### 6. 底部操作栏
```
┌─────────────────────────────────────────────────┐
│ 背景：毛玻璃/半透明白色                          │
│                                                 │
│ [深入分析]  [查看报告]  [开始对话 💬]           │
│                                                 │
└─────────────────────────────────────────────────┘
```
- **固定在底部**：`Positioned(bottom: 0, ...)`
- **背景**：半透明白色 + 轻微模糊
- **按钮**：根据简报的 `actions` 数组动态生成

---

## 🎨 交互设计

### 1. 卡片点击
```
点击卡片
  → Hero 动画（封面图放大）
  → 打开详情页
  → 自动标记为已读
  → 卡片样式变灰（返回列表时）
```

### 2. 操作按钮
简报数据中的 `actions` 字段：
```json
{
  "actions": [
    {
      "label": "深入分析",
      "action": "start_conversation",
      "prompt": "请详细分析框架层返工原因"
    },
    {
      "label": "查看报告",
      "action": "view_report"
    }
  ]
}
```

**按钮类型**：
| Action Type | 行为 | 图标 |
|-------------|------|------|
| `start_conversation` | 打开对话页，预填充 prompt | `chat_bubble` |
| `view_report` | 显示完整的 Markdown 报告 | `article` |
| `open_url` | 打开外部链接 | `open_in_new` |

### 3. 快捷操作（详情页右上角菜单）
- **标记已读**：手动标记
- **关闭简报**：从信息流移除
- **分享**（Phase 4）
- **持续跟踪**（Phase 3）

---

## 📊 简报类型示例

### Type 1: Alert（警报）🔴

**用途**：紧急异常、严重问题

**示例**：
```
标题：返工率达50%，框架层全部变更需返工
类型：alert
优先级：P1
封面：红色渐变（#FEE2E2 → #FECACA）
图标：⚠️ warning_rounded
```

### Type 2: Insight（洞察）🟣

**用途**：趋势分析、深度洞察

**示例**：
```
标题：代码Review效率提升25%，UI模块表现优异
类型：insight
优先级：P2
封面：紫色渐变（#EDE9FE → ##DDD6FE）
图标：💡 lightbulb_rounded
```

### Type 3: Summary（摘要）🔵

**用途**：定期总结、数据汇总

**示例**：
```
标题：本周研发效能周报
类型：summary
优先级：P2
封面：蓝色渐变（#DBEAFE → #BFDBFE）
图标：📊 summarize_rounded
```

### Type 4: Action（待办）🟢

**用途**：需要用户执行的任务

**示例**：
```
标题：3个高优PR等待你的Review
类型：action
优先级：P1
封面：绿色渐变（#D1FAE5 → #A7F3D0）
图标：✅ task_alt_rounded
```

---

## 🔄 状态流转

```
生成（new）
  ↓ 用户打开详情页
已读（read）
  ↓ 用户点击Action按钮
已操作（actioned）
  ↓ 用户手动关闭
已关闭（dismissed）
```

---

## 📐 响应式设计

### 手机端（默认）
- 卡片宽度：屏幕宽度 - 32px（左右各16px）
- 封面高度：240px
- 单列显示

### 平板端（待实现）
- 双列网格布局
- 卡片最大宽度：600px
- 封面高度：280px

### 桌面端（待实现）
- 三列网格布局
- 卡片最大宽度：500px
- 详情页：模态对话框样式

---

## 🎯 设计亮点

### 1. **渐变封面**
- 每种类型有独特的渐变色
- 半透明大图标作为视觉焦点
- 左上角优先级标签清晰可见

### 2. **信息分层**
- **第一眼**：封面颜色 + 优先级 + 未读标记
- **第二眼**：标题（粗体）
- **第三眼**：摘要内容
- **可选**：影响说明（彩色块突出）

### 3. **操作便捷**
- 底部固定操作栏，拇指可触达
- 一键开始对话（预填充 prompt）
- 查看完整报告（Markdown 全屏）

### 4. **状态清晰**
- 未读：边框加粗 + 右上角红点
- 已读：文字变灰
- 优先级：标签颜色不同

---

## 🚀 实现技术栈

- **框架**：Flutter 3.x
- **状态管理**：Riverpod
- **Markdown 渲染**：flutter_markdown
- **动画**：Hero + 默认 Material 过渡
- **网络请求**：dio + Supabase Client

---

## 📝 未来优化方向

### Phase 2（即将实现）
- [ ] 支持真实封面图（网络图片）
- [ ] 图表可视化（echarts_flutter）
- [ ] 更多 Action 类型（open_url, download_report）

### Phase 3（规划中）
- [ ] 持续跟踪功能（订阅特定指标）
- [ ] 简报分组（按 Agent、按时间）
- [ ] 筛选和搜索

### Phase 4（远期）
- [ ] 分享到微信/钉钉
- [ ] 导出 PDF 报告
- [ ] 评论和反馈系统

---

## 📚 参考设计

**灵感来源**：
- 小红书卡片设计（大图 + 文字）
- Apple News 布局（清晰、留白）
- Notion 文档风格（Markdown 渲染）
- Material Design 3 规范（颜色、圆角）

**设计原则**：
> "Less is more. 每一条简报都应该值得用户停下来看3秒。"
