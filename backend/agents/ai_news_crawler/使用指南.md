# AI资讯追踪官 使用指南

## 概述

AI资讯追踪官是一个专门抓取和整理 AI 前沿资讯的 AI 员工，支持多个数据源：

| 数据源 | 脚本 | 说明 |
|--------|------|------|
| [AI工具集](https://ai-bot.cn/daily-ai-news/) | `crawl_aibot.py` | ✅ 推荐，每日更新，国内可访问 |
| [BestBlogs](https://www.bestblogs.dev/articles) | `crawl_articles.py` | 需翻墙，周度更新 |

## 快速开始

### 1. 安装依赖

```bash
pip install httpx beautifulsoup4
```

### 2. 推荐用法：AI工具集日报

```bash
cd backend/agents/ai_news_crawler

# 获取最近 3 天资讯并查看列表
python3 crawl_aibot.py --days 3 --list

# 生成今日日报（Markdown + JSON）
python3 crawl_aibot.py --days 3 --report both

# 只生成 Markdown 日报
python3 crawl_aibot.py --report daily
```

### 3. BestBlogs 周报（需翻墙）

```bash
# 获取最近 7 天的文章
python3 crawl_articles.py --days 7

# 生成周报
python3 crawl_articles.py --report weekly
```

## 命令参数

### crawl_aibot.py（AI工具集）

| 参数 | 说明 | 默认值 |
|------|------|--------|
| `--days N` | 获取最近 N 天的资讯 | 3 |
| `--report TYPE` | 生成报告（daily/json/both） | 无 |
| `--date DATE` | 指定日期生成报告 | 最新一天 |
| `--list` | 只列出资讯，不生成报告 | 否 |

### crawl_articles.py（BestBlogs）

| 参数 | 说明 | 默认值 |
|------|------|--------|
| `--days N` | 获取最近 N 天的文章 | 7 |
| `--category CAT` | 按分类筛选（如"人工智能"） | 无 |
| `--force` | 强制全量更新，忽略缓存 | 否 |
| `--report TYPE` | 生成报告（weekly/daily） | 无 |
| `--list-only` | 只获取列表，不抓取详情 | 否 |

## 目录结构

```
ai_news_crawler/
├── CLAUDE.md              # Agent 角色定义
├── crawl_articles.py      # 爬虫脚本
├── 使用指南.md            # 本文档
├── data/
│   ├── index.json         # 文章索引
│   └── articles/          # 文章详情 (Markdown)
│       ├── 2025-01-06-xxx.md
│       └── ...
└── reports/
    └── weekly_2025-01-06.md  # 周报
```

## 输出格式

### 文章 Markdown 格式

每篇文章保存为带 frontmatter 的 Markdown 文件：

```markdown
---
title: "文章标题"
source: "来源网站"
url: "原文链接"
date: "2025-01-06"
category: "人工智能"
score: 93
word_count: 7469
crawled_at: "2025-01-06T10:00:00"
---

# 文章标题

文章正文内容...
```

### 索引文件格式

`data/index.json` 保存所有文章的元数据：

```json
{
  "last_updated": "2025-01-06T10:00:00",
  "source": "bestblogs.dev",
  "articles": {
    "url-hash": {
      "title": "文章标题",
      "url": "https://...",
      "source": "来源网站",
      "date": "2025-01-06",
      "score": 93,
      "category": "人工智能",
      "summary": "摘要...",
      "file_path": "articles/2025-01-06-xxx.md"
    }
  }
}
```

## 代理配置

如果网络环境需要代理才能访问 bestblogs.dev，可以设置环境变量：

```bash
# 设置代理
export HTTPS_PROXY="http://127.0.0.1:7890"
export HTTP_PROXY="http://127.0.0.1:7890"

# 然后运行爬虫
python crawl_articles.py --days 7
```

## 常见问题

### Q: 如何只更新新文章？

默认行为就是增量更新。脚本会检查 `index.json`，只抓取未记录的新文章。

### Q: 如何强制重新抓取所有文章？

使用 `--force` 参数：

```bash
python crawl_articles.py --days 7 --force
```

### Q: 网站无法访问怎么办？

1. 检查网络连接
2. 确认 https://www.bestblogs.dev 可访问
3. 如果网站结构变化，可能需要更新选择器

### Q: 如何添加新的数据源？

目前仅支持 bestblogs.dev，如需添加新数据源：
1. 在 `crawl_articles.py` 中添加新的解析函数
2. 更新 `CLAUDE.md` 中的数据源配置

## 注意事项

- ⚠️ 请勿频繁执行爬虫，建议每天最多执行 1-2 次
- ⚠️ 爬虫请求间隔为 1.5 秒，请勿修改过小
- ⚠️ 图片仅保留 URL，不会下载图片文件
- ⚠️ 请尊重原文版权，保留来源链接

## 与 AI 对话示例

可以通过对话让 AI资讯追踪官执行任务：

```
用户: 帮我获取最近一周的 AI 资讯

AI: 好的，我来执行爬虫获取最新文章...
    [执行 python crawl_articles.py --days 7]
    
    ✅ 已获取 50 篇文章！
    
    🔥 热门 TOP 5:
    1. 2025：大语言模型年度回顾 - ⭐93
    2. AI Coding 产品的顶层思考 - ⭐93
    ...
```

```
用户: 生成本周的资讯周报

AI: 好的，正在生成周报...
    [执行 python crawl_articles.py --report weekly]
    
    ✅ 周报已生成: reports/weekly_2025-01-06.md
```

