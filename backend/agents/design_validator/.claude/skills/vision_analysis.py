#!/usr/bin/env python3
"""
è§†è§‰åˆ†æ - Prompt æ¨¡æ¿ç”Ÿæˆå™¨

è¿™ä¸ª skill ä¸º Claude Agent æä¾›è®¾è®¡ç¨¿åˆ†æçš„æ ‡å‡†åŒ–æŒ‡å—ã€‚
Agent ä½¿ç”¨è‡ªèº«çš„è§†è§‰èƒ½åŠ›åˆ†æè®¾è®¡ç¨¿å›¾ç‰‡ã€‚

æ”¯æŒä¸‰ç§åˆ†ææ¨¡å¼ï¼š
- mode_a (interaction): äº¤äº’å¯ç”¨æ€§éªŒè¯
- mode_b (visual): è§†è§‰ä¸€è‡´æ€§ä¸æ¸…æ™°åº¦éªŒè¯  
- mode_c (comparison): æ–¹æ¡ˆå¯¹æ¯”ä¸ä¸“ä¸šè¯„ä¼°
"""

import sys
import json


# ============================================================================
# æ¨¡å¼ A: äº¤äº’å¯ç”¨æ€§éªŒè¯
# ============================================================================

MODE_A_PROMPT = """# æ¨¡å¼ A: äº¤äº’å¯ç”¨æ€§éªŒè¯

**è¯„å®¡ç›®æ ‡**: åŸºäºä¸“å®¶è§†è§’ï¼Œåˆ†æäº¤äº’æµç¨‹ä¸­çš„å¯ç”¨æ€§é£é™©ä¸è®¤çŸ¥è´Ÿè·

## æ£€æŸ¥ç»´åº¦

### 1. åŠŸèƒ½å…¥å£ - ç”¨æˆ·è®¤çŸ¥æ¨¡å‹åŒ¹é…åº¦
- åŠŸèƒ½å…¥å£çš„ä½ç½®æ˜¯å¦ç¬¦åˆç”¨æˆ·é¢„æœŸï¼Ÿ
- å…¥å£çš„è§†è§‰å‘ˆç°æ˜¯å¦æ¸…æ™°å¯è¯†åˆ«ï¼Ÿ
- ç”¨æˆ·èƒ½å¦å¿«é€Ÿæ‰¾åˆ°æƒ³è¦çš„åŠŸèƒ½ï¼Ÿ
- å…¥å£æ ‡ç­¾/å›¾æ ‡çš„å«ä¹‰æ˜¯å¦æ˜ç¡®ï¼Ÿ

### 2. æ“ä½œè·¯å¾„ - å¿ƒæ™ºæ¨¡å‹ä¸æ–­ç‚¹æ£€æµ‹
- æ“ä½œæµç¨‹æ˜¯å¦ç¬¦åˆç”¨æˆ·çš„è‡ªç„¶æ€è€ƒæ–¹å¼ï¼Ÿ
- ä»»åŠ¡å®Œæˆè·¯å¾„æ˜¯å¦è¿è´¯ï¼Œæœ‰æ— æ–­ç‚¹æˆ–è·³è½¬æ··ä¹±ï¼Ÿ
- æ­¥éª¤æ•°é‡æ˜¯å¦åˆç†ï¼Œæœ‰æ— å†—ä½™æ“ä½œï¼Ÿ
- å…³é”®æ“ä½œæ˜¯å¦å¯é€†æˆ–å¯ä¿®æ”¹ï¼Ÿ

### 3. äº¤äº’ä¸€è‡´æ€§ - å¹³å°è§„èŒƒç¬¦åˆåº¦
- äº¤äº’æ¨¡å¼æ˜¯å¦ç¬¦åˆ iOS HIG / Android Material Designï¼Ÿ
- ç›¸åŒç±»å‹çš„æ“ä½œæ˜¯å¦é‡‡ç”¨ä¸€è‡´çš„äº¤äº’æ–¹å¼ï¼Ÿ
- æ‰‹åŠ¿æ“ä½œæ˜¯å¦ä¸å¹³å°æƒ¯ä¾‹ä¸€è‡´ï¼Ÿ
- æ§ä»¶ä½¿ç”¨æ˜¯å¦ç¬¦åˆå¹³å°æ ‡å‡†ï¼Ÿ

### 4. çŠ¶æ€åé¦ˆ - æ“ä½œç¡®è®¤å……åˆ†åº¦
- æ“ä½œåæ˜¯å¦æœ‰æ˜ç¡®çš„çŠ¶æ€åé¦ˆï¼Ÿ
- åŠ è½½ã€æˆåŠŸã€å¤±è´¥ç­‰çŠ¶æ€æ˜¯å¦æ¸…æ™°å±•ç¤ºï¼Ÿ
- ç ´åæ€§æ“ä½œæ˜¯å¦æœ‰äºŒæ¬¡ç¡®è®¤ï¼Ÿ
- è¿›åº¦ä¿¡æ¯æ˜¯å¦é€æ˜å¯é¢„æœŸï¼Ÿ

### 5. è®¤çŸ¥è´Ÿè· - å¤æ‚åº¦æ§åˆ¶
- å•é¡µé¢/å•æ­¥éª¤çš„ä¿¡æ¯é‡æ˜¯å¦è¿‡è½½ï¼Ÿ
- é€‰é¡¹å’Œå†³ç­–ç‚¹æ˜¯å¦è¿‡å¤šï¼Ÿ
- æ˜¯å¦å­˜åœ¨è®°å¿†è´Ÿæ‹…è¿‡é‡çš„è®¾è®¡ï¼Ÿ
- æœ¯è¯­å’Œæ ‡ç­¾æ˜¯å¦æ˜“äºç†è§£ï¼Ÿ

## è¾“å‡ºæ ¼å¼

æ¯ä¸ªé—®é¢˜æŒ‰ä»¥ä¸‹æ ¼å¼è¾“å‡ºï¼š

| é¡¹ç›® | å†…å®¹ |
|------|------|
| **é—®é¢˜æè¿°** | [å…·ä½“æè¿°] |
| **é£é™©ç­‰çº§** | ğŸ”´ é«˜ / ğŸŸ¡ ä¸­ / ğŸŸ¢ ä½ |
| **æ¶‰åŠé¡µé¢/å…ƒç´ ** | [å…·ä½“ä½ç½®] |
| **å¯¹ç”¨æˆ·ä½“éªŒçš„å½±å“** | [å½±å“è¯´æ˜] |
| **æ”¹è¿›å»ºè®®** | [è§£å†³æ–¹æ¡ˆ] |

## é£é™©ç­‰çº§æ ‡å‡†

| ç­‰çº§ | æ ‡å‡† |
|------|------|
| ğŸ”´ é«˜ | ä¸¥é‡é˜»ç¢ç”¨æˆ·å®Œæˆæ ¸å¿ƒä»»åŠ¡ |
| ğŸŸ¡ ä¸­ | å¢åŠ ç”¨æˆ·å›°æƒ‘æˆ–æ“ä½œæˆæœ¬ |
| ğŸŸ¢ ä½ | å½±å“ä½“éªŒä½†ä¸é˜»ç¢ä»»åŠ¡å®Œæˆ |

## æ³¨æ„äº‹é¡¹
- âš ï¸ ä»ä¸“ä¸šè§’åº¦å®¢è§‚åˆ†æ
- âš ï¸ ä¸åšä¸»è§‚ç¾å­¦è¯„ä»·
- âš ï¸ è¯†åˆ«å…·ä½“é—®é¢˜ï¼Œä¸ç»™ç»¼åˆè¯„åˆ†
- âš ï¸ æ¯ä¸ªé—®é¢˜éƒ½è¦ç»™å‡ºå¯æ“ä½œçš„æ”¹è¿›å»ºè®®
"""

# ============================================================================
# æ¨¡å¼ B: è§†è§‰ä¸€è‡´æ€§ä¸æ¸…æ™°åº¦éªŒè¯
# ============================================================================

MODE_B_PROMPT = """# æ¨¡å¼ B: è§†è§‰ä¸€è‡´æ€§ä¸æ¸…æ™°åº¦éªŒè¯

**è¯„å®¡ç›®æ ‡**: æ£€æŸ¥è§†è§‰è®¾è®¡çš„å±‚çº§ã€ä¸€è‡´æ€§å’Œæ½œåœ¨è¯¯å¯¼æ€§

## æ£€æŸ¥ç»´åº¦

### 1. é¢œè‰²ä½¿ç”¨
- æ˜¯å¦ç¬¦åˆå“ç‰Œè‰²æ¿ï¼Ÿ
- é¢œè‰²å¯¹æ¯”åº¦æ˜¯å¦è¾¾æ ‡ï¼ˆWCAG AAçº§ >= 4.5:1ï¼‰ï¼Ÿ
- æ˜¯å¦è¿‡åº¦ä½¿ç”¨é¢œè‰²ï¼Ÿ
- é¢œè‰²è¯­ä¹‰æ˜¯å¦æ­£ç¡®ï¼ˆå¦‚çº¢è‰²è¡¨ç¤ºé”™è¯¯/å±é™©ï¼‰ï¼Ÿ

### 2. å­—ä½“å­—å·
- æ˜¯å¦éµå¾ª Type Scaleï¼Ÿ
- æœ€å°å­—å·æ˜¯å¦ >= 12ptï¼Ÿ
- æ ‡é¢˜å±‚çº§æ˜¯å¦æ¸…æ™°ï¼Ÿ
- å¯è¯»æ€§æ˜¯å¦è‰¯å¥½ï¼Ÿ

### 3. é—´è·å¸ƒå±€
- æ˜¯å¦éµå¾ª 8pt Gridï¼Ÿ
- å…ƒç´ å¯¹é½æ˜¯å¦è§„èŒƒï¼Ÿ
- ç•™ç™½æ˜¯å¦åˆç†ï¼Ÿ
- ä¿¡æ¯åˆ†ç»„æ˜¯å¦æ¸…æ™°ï¼Ÿ

### 4. è§†è§‰å±‚çº§
- ä¸»æ¬¡ä¿¡æ¯æ˜¯å¦åˆ†æ˜ï¼Ÿ
- å…³é”®æ“ä½œæ˜¯å¦çªå‡ºï¼Ÿ
- è§†è§‰æµå‘æ˜¯å¦è‡ªç„¶ï¼Ÿ
- æ˜¯å¦å­˜åœ¨è¯¯å¯¼ç”¨æˆ·çš„è®¾è®¡ï¼Ÿ

### 5. ç»„ä»¶ä¸€è‡´æ€§
- æ˜¯å¦ä½¿ç”¨äº†è®¾è®¡ç³»ç»Ÿä¸­çš„æ ‡å‡†ç»„ä»¶ï¼Ÿ
- åŒç±»å…ƒç´ æ ·å¼æ˜¯å¦ç»Ÿä¸€ï¼Ÿ
- æ˜¯å¦æœ‰é‡å¤é€ è½®å­çš„æƒ…å†µï¼Ÿ

## è¾“å‡ºæ ¼å¼

| é—®é¢˜ | ä¸¥é‡ç¨‹åº¦ | æ¶‰åŠå…ƒç´  | ä¿®å¤å»ºè®® |
|------|----------|----------|----------|
| [æè¿°] | é«˜/ä¸­/ä½ | [ä½ç½®] | [å»ºè®®] |

## ä¸€è‡´æ€§è¯„ä¼°æ±‡æ€»
- âœ…/âš ï¸/âŒ é¢œè‰²: [è¯„ä¼°]
- âœ…/âš ï¸/âŒ å­—ä½“: [è¯„ä¼°]
- âœ…/âš ï¸/âŒ é—´è·: [è¯„ä¼°]
- âœ…/âš ï¸/âŒ ç»„ä»¶: [è¯„ä¼°]
"""

# ============================================================================
# æ¨¡å¼ C: æ–¹æ¡ˆå¯¹æ¯”ä¸ä¸“ä¸šè¯„ä¼°
# ============================================================================

MODE_C_PROMPT = """# æ¨¡å¼ C: æ–¹æ¡ˆå¯¹æ¯”ä¸ä¸“ä¸šè¯„ä¼°

**è¯„å®¡ç›®æ ‡**: ä»ä¸“å®¶è§†è§’å¯¹æ¯”å¤šä¸ªæ–¹æ¡ˆçš„å¯ç”¨æ€§ä¸ä½“éªŒå·®å¼‚

## è¯„ä¼°ç»´åº¦

### 1. è®¤çŸ¥éš¾åº¦
ç”¨æˆ·ç†è§£è®¾è®¡æ„å›¾æ‰€éœ€çš„è®¤çŸ¥æˆæœ¬

### 2. æ“ä½œæ•ˆç‡
å®Œæˆä»»åŠ¡æ‰€éœ€çš„æ­¥éª¤æ•°å’Œå¤æ‚åº¦

### 3. å†³ç­–è´Ÿè·
ç”¨æˆ·åœ¨æ“ä½œè¿‡ç¨‹ä¸­éœ€è¦åšå‡ºçš„é€‰æ‹©å’Œåˆ¤æ–­

### 4. ç¬¦åˆé¢„æœŸ
è®¾è®¡æ˜¯å¦ç¬¦åˆç”¨æˆ·çš„å¿ƒæ™ºæ¨¡å‹å’Œå¹³å°è§„èŒƒ

### 5. å¿ƒç†è´Ÿæ‹…
æ“ä½œè¿‡ç¨‹ä¸­å¯èƒ½äº§ç”Ÿçš„ç„¦è™‘æˆ–å›°æƒ‘

## è¾“å‡ºæ ¼å¼

### æ–¹æ¡ˆå¯¹æ¯”çŸ©é˜µ
| ç»´åº¦ | æ–¹æ¡ˆA | æ–¹æ¡ˆB | ... |
|------|-------|-------|-----|
| è®¤çŸ¥éš¾åº¦ | [å…·ä½“åˆ†æ] | [å…·ä½“åˆ†æ] | ... |
| æ“ä½œæ•ˆç‡ | [å…·ä½“åˆ†æ] | [å…·ä½“åˆ†æ] | ... |
| å†³ç­–è´Ÿè· | [å…·ä½“åˆ†æ] | [å…·ä½“åˆ†æ] | ... |
| ç¬¦åˆé¢„æœŸ | [å…·ä½“åˆ†æ] | [å…·ä½“åˆ†æ] | ... |
| å¿ƒç†è´Ÿæ‹… | [å…·ä½“åˆ†æ] | [å…·ä½“åˆ†æ] | ... |

### æ¨èæ–¹æ¡ˆåŠç†ç”±

## æ³¨æ„äº‹é¡¹
- âš ï¸ ä»ä¸“ä¸šè§’åº¦å®¢è§‚åˆ†æ
- âš ï¸ ä¸åšä¸»è§‚ç¾å­¦è¯„ä»·
- âš ï¸ è¯†åˆ«å…·ä½“é—®é¢˜
- âš ï¸ ä¸ç»™ç»¼åˆè¯„åˆ†
"""

# ============================================================================
# çŸ¥è¯†åº“ç´¢å¼•
# ============================================================================

KNOWLEDGE_BASE_INDEX = """
## çŸ¥è¯†åº“å‚è€ƒ

åˆ†æå‰å¯æŸ¥é˜…ä»¥ä¸‹æ–‡ä»¶ï¼š

- `knowledge_base/design_guidelines/interaction-guidelines.md` - äº¤äº’è§„èŒƒ
- `knowledge_base/design_guidelines/visual-guidelines.md` - è§†è§‰è§„èŒƒ
- `knowledge_base/design_decisions/` - å†å²è®¾è®¡å†³ç­–ï¼ˆç”¨ Grep æœç´¢ï¼‰
- `knowledge_base/case_studies/` - æˆåŠŸ/é—®é¢˜æ¡ˆä¾‹
"""


def generate_prompt(
    mode: str = "interaction",
    design_context: str = "",
    core_task: str = "",
    specific_concerns: str = "",
    user_persona: str = ""
) -> str:
    """
    ç”Ÿæˆè®¾è®¡åˆ†æçš„å®Œæ•´ prompt
    
    Args:
        mode: åˆ†ææ¨¡å¼ (interaction/visual/comparison)
        design_context: è®¾è®¡èƒŒæ™¯è¯´æ˜
        core_task: æ ¸å¿ƒä»»åŠ¡æè¿°
        specific_concerns: ç‰¹åˆ«å…³æ³¨çš„é—®é¢˜
        user_persona: ç”¨æˆ·ç”»åƒï¼ˆæ–¹æ¡ˆå¯¹æ¯”æ¨¡å¼ä½¿ç”¨ï¼‰
    """
    
    # é€‰æ‹©å¯¹åº”æ¨¡å¼çš„ prompt
    mode_prompts = {
        "interaction": MODE_A_PROMPT,
        "visual": MODE_B_PROMPT,
        "comparison": MODE_C_PROMPT,
        # å…¼å®¹æ—§å‚æ•°
        "mode_a": MODE_A_PROMPT,
        "mode_b": MODE_B_PROMPT,
        "mode_c": MODE_C_PROMPT,
    }
    
    mode_prompt = mode_prompts.get(mode, MODE_A_PROMPT)
    
    # æ„å»ºå®Œæ•´ prompt
    prompt = f"""# è®¾è®¡ç¨¿åˆ†æä»»åŠ¡

## è®¾è®¡èƒŒæ™¯

- **é¡µé¢/åŠŸèƒ½**: {design_context or "è¯·æ ¹æ®è®¾è®¡ç¨¿è¯†åˆ«"}
- **æ ¸å¿ƒä»»åŠ¡**: {core_task or "è¯·æ ¹æ®è®¾è®¡ç¨¿æ¨æ–­"}
- **ç›®æ ‡ç”¨æˆ·**: {user_persona or "æ™®é€šç”¨æˆ·"}
- **ç‰¹åˆ«å…³æ³¨**: {specific_concerns or "æ— ï¼Œè¿›è¡Œå…¨é¢æ£€æŸ¥"}

---

{mode_prompt}

---

{KNOWLEDGE_BASE_INDEX}

---

è¯·åˆ†æè®¾è®¡ç¨¿ï¼ŒæŒ‰ç…§ä¸Šè¿°è¦æ±‚è¾“å‡ºç»“æœã€‚
"""
    
    return prompt


def main():
    """ä¸»å‡½æ•°ï¼šä» stdin è¯»å–å‚æ•°ï¼Œè¾“å‡º prompt"""
    
    input_data = sys.stdin.read().strip()
    
    if not input_data:
        # æ— è¾“å…¥æ—¶è¿”å›é»˜è®¤ promptï¼ˆäº¤äº’å¯ç”¨æ€§æ¨¡å¼ï¼‰
        result = {
            "success": True,
            "mode": "interaction",
            "prompt": generate_prompt(),
            "available_modes": ["interaction", "visual", "comparison"],
            "usage": "å°†æ­¤ prompt ä¸è®¾è®¡ç¨¿å›¾ç‰‡ä¸€èµ·å‘é€ç»™ Agent"
        }
    else:
        try:
            params = json.loads(input_data)
            
            mode = params.get("mode", params.get("focus", "interaction"))
            design_context = params.get("design_context", "")
            core_task = params.get("core_task", "")
            specific_concerns = params.get("specific_concerns", "")
            user_persona = params.get("user_persona", "")
            
            result = {
                "success": True,
                "mode": mode,
                "prompt": generate_prompt(
                    mode=mode,
                    design_context=design_context,
                    core_task=core_task,
                    specific_concerns=specific_concerns,
                    user_persona=user_persona
                ),
                "params": params
            }
        except json.JSONDecodeError as e:
            result = {
                "success": False,
                "error": f"JSON è§£æé”™è¯¯: {str(e)}",
                "usage": "è¾“å…¥æ ¼å¼: {\"mode\": \"interaction\", \"design_context\": \"...\", ...}"
            }
    
    print(json.dumps(result, ensure_ascii=False, indent=2))


if __name__ == "__main__":
    main()
